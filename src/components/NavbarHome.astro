---
import { Image } from "astro:assets";
import upperWaves from "../assets/logo/logoCMPupperWavesColored.svg";
import lowerWaves from "../assets/logo/logoCMPlowerWavesColored.svg";
import logoTextNavbar from "../assets/logo/logoTextCMPnavbar.svg";
import logoTextColored from "../assets/logo/logoTextCMPcolored.svg";
---

<nav id="navbar" class="w-full fixed top-0 left-0 z-50 bg-transparent transition-all duration-300">
  <div class="max-w-7xl mx-auto px-4 flex justify-between items-center h-content">
    <div id="nav-links" class="w-full flex md:grid md:grid-cols-3 justify-center items-center gap-4 h-32 md:h-40 transition-all duration-300">

      <!-- Menu gauche -->
      <ul class="hidden md:flex justify-end space-x-8 text-lg font-medium text-[#313181]">
        <li>
          <a href="/#our-offices" class="hover:text-[#FFFFFF] transition cursor-pointer">Nos cabinets</a>
        </li>
        <li>
          <a href="/#our-team" class="hover:text-[#FFFFFF] transition cursor-pointer">Notre équipe</a>
        </li>
      </ul>

      <!-- Logo centré et agrandi -->
      <a id="nav-logo" href="/" class="font-bold text-gray-800 h-38 md:h-48 transition-all duration-400 flex flex-col items-center justify-self-center mt-[5rem] md:mt-[2rem]">
        <Image id="upperWaves" src={upperWaves} alt="Upper Waves" class="h-1/3 transition-all duration-300" />
        
        <!-- Deux versions du texte superposées -->
        <div id="middleTextContainer" class="relative h-[3.5rem] md:h-[4rem] flex items-center justify-center transition-all duration-300">
          <Image 
            id="middleTextDefault" 
            src={logoTextNavbar} 
            alt="Nav Image" 
            class="h-full w-auto transition-all duration-300 opacity-100" 
          />
          <Image 
            id="middleTextScrolled" 
            src={logoTextColored} 
            alt="Nav Image Scrolled" 
            class="absolute h-full w-auto inset-0 m-auto transition-all duration-300 opacity-0" 
          />
        </div>
        
        <Image id="lowerWaves" src={lowerWaves} alt="Lower Waves" class="h-1/3 transition-all duration-300" />
      </a>

      <!-- Menu droite -->
      <ul class="hidden md:flex justify-start space-x-8 text-lg font-medium text-[#313181]">
        <li>
          <a href="/#faq" class="hover:text-[#FFFFFF] transition cursor-pointer">Vos questions</a>
        </li>
        <li>
          <a href="/contact" class="hover:text-[#FFFFFF] transition cursor-pointer">Contactez-nous</a>
        </li>
      </ul>
    </div>
    
    <!-- Burger mobile -->
      <button class="text-[#313181] absolute right-10 md:hidden flex items-center text-3xl">
        ☰
      </button>
  </div>
</nav>

<script is:inline>
  const navbar = document.getElementById('navbar');
  const upper = document.getElementById('upperWaves');
  const middleDefault = document.getElementById('middleTextDefault');
  const middleScrolled = document.getElementById('middleTextScrolled');
  const lower = document.getElementById('lowerWaves');
  const logo = document.getElementById('nav-logo');

  function isMobile() {
    return window.innerWidth < 768; // md breakpoint de Tailwind
  }

  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      navbar.classList.add('scrolled');
      upper.style.height = '0';
      lower.style.height = '0';
      upper.style.opacity = '0';
      lower.style.opacity = '0';
      logo.style.justifyContent = 'center';
      logo.style.height = '3rem';
      
      // Changer les images texte
      logo.style.marginTop = '0';
      middleDefault.style.opacity = '0';
      middleScrolled.style.opacity = '1';
    } else {
      navbar.classList.remove('scrolled');
      upper.style.height = '33%';
      lower.style.height = '33%';
      upper.style.opacity = '1';
      lower.style.opacity = '1';
      logo.style.height = '12rem';
      
      // Revenir à l'image par défaut
      logo.style.marginTop = isMobile() ? '5rem' : '2rem';
      middleDefault.style.opacity = '1';
      middleScrolled.style.opacity = '0';
    }
  });
</script>

<style>
  nav {
    transition: all 0.3s ease;
  }
  nav.scrolled {
    padding-top: 0.25rem;
    padding-bottom: 0.25rem;
    margin: 1rem;
    border-radius: 0.5rem;
    box-shadow: 0 10px 25px rgba(0,0,0,0.05);
    width: calc(100% - 2rem);
    backdrop-filter: blur(10px);
    background-color: rgb(255, 255, 255, 0.9);
  }
  nav.scrolled #nav-links {
    height: 5rem;
  }
  nav.scrolled img {
    transition: all 0.3s ease;
  }
</style>